package com.leetcode.question.group1;

/**
 * @author yanbin
 * @date 2020/10/21 18:27
 */
//ç»™ä½ ä¸€ä¸ªå­—ç¬¦ä¸² s å’Œä¸€ä¸ªå­—ç¬¦è§„å¾‹ pï¼Œè¯·ä½ æ¥å®ç°ä¸€ä¸ªæ”¯æŒ '.' å’Œ '*' çš„æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…ã€‚
//
// '.' åŒ¹é…ä»»æ„å•ä¸ªå­—ç¬¦
//'*' åŒ¹é…é›¶ä¸ªæˆ–å¤šä¸ªå‰é¢çš„é‚£ä¸€ä¸ªå…ƒç´ 
//
//
// æ‰€è°“åŒ¹é…ï¼Œæ˜¯è¦æ¶µç›– æ•´ä¸ª å­—ç¬¦ä¸² sçš„ï¼Œè€Œä¸æ˜¯éƒ¨åˆ†å­—ç¬¦ä¸²ã€‚
//
// è¯´æ˜:
//
//
// s å¯èƒ½ä¸ºç©ºï¼Œä¸”åªåŒ…å«ä» a-z çš„å°å†™å­—æ¯ã€‚
// p å¯èƒ½ä¸ºç©ºï¼Œä¸”åªåŒ…å«ä» a-z çš„å°å†™å­—æ¯ï¼Œä»¥åŠå­—ç¬¦ . å’Œ *ã€‚
//
//
// ç¤ºä¾‹ 1:
//
// è¾“å…¥:
//s = "aa"
//p = "a"
//è¾“å‡º: false
//è§£é‡Š: "a" æ— æ³•åŒ¹é… "aa" æ•´ä¸ªå­—ç¬¦ä¸²ã€‚
//
//
// ç¤ºä¾‹ 2:
//
// è¾“å…¥:
//s = "aa"
//p = "a*"
//è¾“å‡º: true
//è§£é‡Š:Â å› ä¸º '*' ä»£è¡¨å¯ä»¥åŒ¹é…é›¶ä¸ªæˆ–å¤šä¸ªå‰é¢çš„é‚£ä¸€ä¸ªå…ƒç´ , åœ¨è¿™é‡Œå‰é¢çš„å…ƒç´ å°±æ˜¯ 'a'ã€‚å› æ­¤ï¼Œå­—ç¬¦ä¸² "aa" å¯è¢«è§†ä¸º 'a' é‡å¤äº†ä¸€æ¬¡ã€‚
//
//
// ç¤ºä¾‹ 3:
//
// è¾“å…¥:
//s = "ab"
//p = ".*"
//è¾“å‡º: true
//è§£é‡Š:Â ".*" è¡¨ç¤ºå¯åŒ¹é…é›¶ä¸ªæˆ–å¤šä¸ªï¼ˆ'*'ï¼‰ä»»æ„å­—ç¬¦ï¼ˆ'.'ï¼‰ã€‚
//
//
// ç¤ºä¾‹ 4:
//
// è¾“å…¥:
//s = "aab"
//p = "c*a*b"
//è¾“å‡º: true
//è§£é‡Š:Â å› ä¸º '*' è¡¨ç¤ºé›¶ä¸ªæˆ–å¤šä¸ªï¼Œè¿™é‡Œ 'c' ä¸º 0 ä¸ª, 'a' è¢«é‡å¤ä¸€æ¬¡ã€‚å› æ­¤å¯ä»¥åŒ¹é…å­—ç¬¦ä¸² "aab"ã€‚
//
//
// ç¤ºä¾‹ 5:
//
// è¾“å…¥:
//s = "mississippi"
//p = "mis*is*p*."
//è¾“å‡º: false
// Related Topics å­—ç¬¦ä¸² åŠ¨æ€è§„åˆ’ å›æº¯ç®—æ³•
// ğŸ‘ 1625 ğŸ‘ 0
public class Question10_Hard {
    /**
     * 2ï¼‰åŠ¨æ€è§„åˆ’
     * *s*å’Œ*p*å€’ç€çœ‹ï¼Œ*dp[i][j]*çš„å–å€¼åˆ†ä¸ºä»¥ä¸‹å‡ ç§æƒ…å†µï¼š
     * * 1.*p[j - 1]*ä¸ºæ™®é€šå­—ç¬¦,è‹¥*s[i - 1] == p[j - 1]*ï¼Œåˆ™*dp[i][j] = dp[i - 1][j - 1]*ï¼Œå¦åˆ™åŒ¹é…å¤±è´¥
     * * 2.*p[j - 1]*ä¸º`'.'`ï¼Œåˆ™*dp[i][j] = dp[i - 1][j - 1]*
     * * 3.*p[j - 1]*ä¸º`'*'`ï¼š
     *   * (1)ä¸çœ‹ï¼Œåˆ™*dp[i][j] = dp[i][j - 2]*
     *   * (2)çœ‹ï¼Œåˆ™*dp[i][j] = dp[i - 1][j]*
     * @param s
     * @param p
     * @return
     */
    public boolean isMatch(String s, String p) {
        char[] str = s.toCharArray(), ptr = p.toCharArray();
        boolean[][] dp = new boolean[str.length + 1][ptr.length + 1];
        dp[0][0] = true;
        for (int i = 0; i <= str.length; i++) {
            for (int j = 1; j <= ptr.length; j++) {
                if(ptr[j - 1] != '*') {
                    if(i > 0 && (str[i - 1] == ptr[j - 1] || ptr[j - 1] == '.')) dp[i][j] = dp[i - 1][j - 1];
                }else { //ptr[j - 1] == '*'
                    if(j > 1) dp[i][j] |= dp[i][j - 2];   //ä¸çœ‹
                    if(i > 0 && j > 1 && (str[i - 1] == ptr[j - 2] || ptr[j - 2] == '.'))dp[i][j] |= dp[i - 1][j];    //çœ‹
                }
            }
        }
        return dp[str.length][ptr.length];
    }

    /**
     * ä»å¤´å¤„ç†*s*å’Œ*p*ä¸¤ä¸ªå­—ç¬¦ä¸²ï¼š
     *
     * é¦–å…ˆï¼Œå¦‚æœ*p*ä¸ºç©ºäº†ï¼Œæ­¤æ—¶è‹¥*s*ä¸ä¸ºç©ºï¼Œåˆ™è¯´æ˜åŒ¹é…å¤±è´¥ï¼Œç›´æ¥è¿”å›*false*ï¼Œå¦‚æœéƒ½ä¸ºç©ºï¼Œè¯´æ˜åŒ¹é…ç»“æŸï¼Œè¿”å›*true*ã€‚
     * å…¶æ¬¡ï¼Œå¦‚æœ*p*ä¸ä¸ºç©ºï¼Œå­˜åœ¨ä¸¤ç§æƒ…å†µï¼Œä¸€ç§æ˜¯å•ä¸€åŒ¹é…ï¼Œä¸€ç§æ˜¯`'*'`çš„ä»»æ„åŒ¹é…ã€‚
     *   * æˆ‘ä»¬å…ˆå‡è®¾å•ä¸€åŒ¹é…ï¼Œåˆ›å»ºä¸€ä¸ª`boolean`ç±»å‹çš„`match`å˜é‡ï¼Œè®¡ç®—ä¸€ä¸‹å•ä¸€åŒ¹é…æ˜¯å¦æˆåŠŸï¼š
     *     * åœ¨å•ä¸€åŒ¹é…çš„æƒ…å†µä¸‹ï¼Œ*s*ä¸èƒ½ä¸ºç©ºã€‚
     *     * *s*å’Œ*p*çš„å½“å‰ç¬¬ä¸€ä¸ªå­—ç¬¦éœ€è¦ç›¸ç­‰ï¼Œæˆ–è€…pçš„ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸º`'.'`ã€‚
     *
     *   å¦‚æœæˆåŠŸå°±å¯ä»¥å°†ä¸¤ä¸ªå­—ç¬¦ä¸²çš„ç¬¬ä¸€ä½å»æ‰ï¼Œç»§ç»­åŒ¹é…åç»­çš„å­—ç¬¦ã€‚
     *   * è¿˜æœ‰å¯èƒ½æ˜¯è¦è¿›è¡Œä»»æ„åŒ¹é…ï¼Œä»»æ„åŒ¹é…çš„æ¡ä»¶æ˜¯å½“å‰*p*çš„å¤§å°éœ€è¦å¤§äº2ï¼Œå¹¶ä¸”*p[1]*è¦ä¸º`'*'`ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œå¯ä»¥åŒ¹é…*s*ä¸­ä»»æ„æ•°é‡çš„å­—ç¬¦*p[0]*ã€‚é‚£ä¹ˆåˆæ˜¯ä¸¤ç§æƒ…å†µï¼š
     *     * çœ‹ï¼šå¦‚æœçœ‹ï¼ˆåŒ¹é…ï¼‰ä¸€æ¬¡ï¼Œå°±ç›¸å½“äºå»æ‰*s*çš„ç¬¬ä¸€ä¸ªå­—ç¬¦ï¼Œç»§ç»­å‘ååŒ¹é…ã€‚
     *     * ä¸çœ‹ï¼šå¦‚æœä¸çœ‹ï¼ˆå°±æ˜¯ä¸è¿›è¡ŒåŒ¹é…=åŒ¹é…0æ¬¡ï¼‰ï¼Œå°±ç›¸å½“äº*s*ä¸å˜ï¼Œ*p*å‘åå»æ‰ä¸¤ä½ï¼ˆå­—ç¬¦*p[0]*å’Œ*p[1]*çš„`'*'`ï¼‰ã€‚
     * @param s
     * @param s1
     * @param p
     * @param p1
     * @return
     */
    public boolean isMatchChar(char[] s, int s1, char[] p, int p1) {
        if(p1 >= p.length) return s1 >= s.length;
        boolean match = s1 < s.length && ((s[s1] == p[p1]) || p[p1] == '.');
        if(p.length - p1 >= 2 && p[p1 + 1] == '*') return isMatchChar(s, s1, p, p1 + 2) || (match && isMatchChar(s, s1 + 1, p, p1));
        return match && isMatchChar(s, s1 + 1, p, p1 + 1);
    }
    public boolean isMatch1(String s, String p) {
        char[] ss = s.toCharArray(), pp = p.toCharArray();
        return isMatchChar(ss, 0, pp, 0);
    }


    public boolean isMatch3(String s, String p) {
        if (p.length() == 0) {
            return s.length() == 0;
        }
        if (p.length() > 1 && p.charAt(1) == '*') {
            // pçš„ç¬¬äºŒä¸ªå­—ç¬¦æ˜¯ '*'
            //1,å­—ç¬¦"*"æŠŠå‰é¢çš„å­—ç¬¦æ¶ˆæ‰ï¼Œä¹Ÿå°±æ˜¯åŒ¹é…0æ¬¡
            //2,å­—ç¬¦"*"åŒ¹é…1æ¬¡æˆ–å¤šæ¬¡
            return isMatch3(s, p.substring(2)) || (s.length() > 0 && comp(s, p)) && isMatch3(s.substring(1), p);
        } else {
            // pçš„ç¬¬äºŒä¸ªå­—ç¬¦ä¸æ˜¯ '*'ï¼Œåˆ¤æ–­é¦–å­—ç¬¦æ˜¯å¦ç›¸åŒï¼Œå¦‚æœç›¸åŒå†ä»ç¬¬äºŒä½ç»§ç»­æ¯”è¾ƒ
            return s.length() > 0 && comp(s, p) && (isMatch3(s.substring(1), p.substring(1)));
        }
    }
    //æ¯”è¾ƒsçš„é¦–å­—ç¬¦å’Œpçš„é¦–å­—ç¬¦æ˜¯å¦åŒ¹é…
    private boolean comp(String s, String p) {
        return s.charAt(0) == p.charAt(0) || p.charAt(0) == '.';
    }

}
